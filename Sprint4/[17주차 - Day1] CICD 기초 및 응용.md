### 쿠버네티스

- 마이크로서비스 아키텍처
    - 응용 서시스템 개발 및 구성을 위한 아키텍처 스타일의 하나
    - 전통적인 방식의 아키텍처는 ‘모놀로식 아키텍처’라고 부르기도한다
    - 컨테이너 모델은 마이크로서비스를 구현하기 적합
- 컨테이너 오케스트레이션 솔루션
    - 다수의 컨테이너들을 관리하면서
    - 자동 배포, 배포된 컨테이너 동작 보증, 부하에 따른 확장 등 기능 담당
- 도커와 잘 어울리는 실행 환경 구성 도구
    - CI/CD 유효하게 적용 가능
    - 도커 컨테이너들을 클러스터 내에 실행하고 관리하는 데 적합
- 쿠버네티스 클러스터의 구성 요소
    - 클러스터는 하나 이상의 노드들로 구성됨
    - 마스터 노드
        - kubectl, API 서버, etcd, 컨트롤러 매니저, 스케줄러
    - 워커 노드
        - 컨테이너 런타임, kubelet

### 쿠버네티스 기능

- 컨테이너 밸런싱
- 트래픽 로드 밸런싱
- 동적 수평 스케일링
- 오류 복구
- 롤링 업데이트
- 스토리지 오케스트레이션
- 서비스 디스커버리

### 쿠버네티스 오브젝트들

- Pod : 한 개 이상의 컨테이너로 단일 목적의 일을 하기 위해 모인 단위
- Namespace : k8s 클러스터에서 사용되는 리소스들을 구분해 관리하는 그룹
- Volume : 포드가 생성될 때 포드에서 사용할 수 있는 디렉토리를 제공
- Service : 유동적인 포드들에 대한 접속을 안정적으로 유지하는 역활

### 쿠버네티스 기본 사용법

- 노드와 포드 정보 조회
    - 명령어
        - kubectl get nodes
        - kubectl get pods
- Delployment
    - 응용의 배포를 위해 많이 이용되는 k8s 오브젝트 형태
    - 디플로이먼트 상태를 선언하면 k8s가 동적으로 의도된 상태가 되도록 레플리카셋을 관리

### 디플로이먼트 상태 유지

- 디플로이먼트에 의하여 포드들이 배포된 상태에서 하나 이상의 포드가 사멸하면 k8s는 새로운 포드를  생성하고 같은 종류의 컨테이너를 실행함
- 포드가 사멸시 새로운 포드를 생성함으로 ‘의도된 상태’를 유지하려고한다
- 클러스터 외부에 별도의 서비스에 의하여 노출되므로 개별 포드 클러스터 내 IP 주 소등에 대해서는 사용자가 관리할 필요가 없다
- 단 포드는 언제든지 죽을 수 있으므로 상태를 띠지 않은 ‘stateless’ 방식으로 만들어야한다

### 포드의 동작 보증

- 디플로이먼트에 의하여 배포된 컨테이너 실행에 문제가 생기면 k8s는 이 컨테이너를 삭제하고 다시 컨테이너를 생성해 응용을 지속 실행
- k8s에 의하여 관리되는 포드는 복구할 수 없는 오류를 맞닥뜨리는 경우에도 재시작한다

### 포드의 업데이트와 복구

- 배포된 소프트웨어 업데으토와 복구
    - 소프트웨어의 업데이트가 발생함에 따라 동적 업데이트 필요
    - 여기에서는 수동으로 업데이트 적용하는 실습을 통해 활용
    
    > kubectl rollout status
    kubectl rollout history
    > 

### 쿠버네티스 서비스와 볼륨

- 서비스
    - 클러스터에 외부에서 클러스터에 접속하는 방법 ⇒ 내부 동작 기능을 외부로 “노출”
- 노드 포트
    - 모든 워커 노드의 특정 포트를 열고 여기로 오는 모든 요청을 노드포트 서비스에 전달
    - 노드포트 서비스는 해당 요청을 처리할 수 있는 포드로 요청을 전달
- 로드 밸런서
    - 클러스터 외부의 로드밸런서를 이용하여 부하 균등화 수행
    - 노드포트와 달리 특정 노드가 접근 불가능한 경우에도 서비스 제공 가능
- 볼륨
    - k8s는 클러스터 내에서 이용할 수 있는 저장장치의 추상화된 객체로 볼륨을 정의
    - PV (PersistentVolume)
    - 클러스터 내에 존재하는 스토리지를 추상화 한 것
    - PVC (PersistentVolumeClaim)

### CI 도구로서 젠킨스

- CI(Continuous Inteegration) 단계
    - 일반적으로 개발자가 소스코드를 커밋하고 푸시하는 것으로 시작
- CD(Continuouse Delivery/Deployment) 단계
    - CI 단계에서 소프트웨어가 배포 가능한 상태임을 확인하는 것으로 시작
- 젠킨스 특징
    - 다양한 프로그래밍 언어 지원
    - 플러그인을 통한 확장, 이식성, 대부분의 소스 관리 시스템 지원
    - 분산 처리 지원, 코드로 파이프라인 구성
- 젠킨스 아키텍처
    - 마스터-슬레이브 구조
    - 마스터 : 빌드 시작 트리거 포착, 알림, HTTP 요청 처리
    - 에이전트 : 마스터에 의한 개시 후 모든 작업을 처리